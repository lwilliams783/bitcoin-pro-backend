<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bitcoin Pro - Live Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container { max-width: 1200px; margin: 0 auto; }
        
        .header {
            text-align: center;
            padding: 25px;
            background: rgba(0,0,0,0.3);
            border-radius: 20px;
            margin-bottom: 25px;
        }
        
        h1 { font-size: 2.8em; margin-bottom: 10px; }
        h2 { font-size: 1.5em; margin-bottom: 20px; }
        
        .status {
            display: inline-block;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 0.9em;
            font-weight: bold;
            margin-top: 10px;
        }
        
        .status.live { background: rgba(16, 185, 129, 0.3); border: 3px solid #10b981; }
        .status.error { background: rgba(239, 68, 68, 0.3); border: 3px solid #ef4444; }
        
        .card {
            background: rgba(255,255,255,0.15);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
        }
        
        .stat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .stat-box {
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }
        
        .stat-box.highlight {
            border: 2px solid #10b981;
            background: rgba(16, 185, 129, 0.2);
        }
        
        .stat-value { font-size: 1.8em; font-weight: bold; margin-bottom: 8px; }
        .stat-label { font-size: 0.85em; opacity: 0.9; }
        
        .prediction-card {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .prediction-card.bullish { border-left: 5px solid #10b981; }
        .prediction-card.bearish { border-left: 5px solid #ef4444; }
        .prediction-card.neutral { border-left: 5px solid #f59e0b; }
        
        .macro-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .macro-box {
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 18px;
            text-align: center;
            border: 2px solid transparent;
        }
        
        .macro-box.bullish { border-color: #10b981; background: rgba(16, 185, 129, 0.15); }
        .macro-box.bearish { border-color: #ef4444; background: rgba(239, 68, 68, 0.15); }
        
        .fed-section {
            background: rgba(59, 130, 246, 0.2);
            border: 2px solid #3b82f6;
            border-radius: 20px;
            padding: 25px;
            margin-top: 25px;
        }
        
        .fed-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .fed-box {
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            padding: 18px;
            text-align: center;
        }
        
        button {
            width: 100%;
            background: rgba(16, 185, 129, 0.3);
            border: 3px solid #10b981;
            color: white;
            padding: 18px;
            border-radius: 15px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            margin-top: 25px;
        }
        
        button:hover { background: rgba(16, 185, 129, 0.5); }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ Bitcoin Pro</h1>
            <p style="font-size: 1.1em; margin: 5px 0;">Real-Time Market Intelligence</p>
            <div id="statusBadge" class="status live">üü¢ LIVE</div>
            <p style="font-size: 0.85em; margin-top: 10px; opacity: 0.8;">
                Last Update: <span id="lastUpdate">--</span>
            </p>
        </div>

        <div class="card">
            <h2 style="text-align: center;">‚ö° Bitcoin Live Price</h2>
            <div style="text-align: center; font-size: 3.5em; font-weight: bold; color: #10b981; margin: 20px 0;" id="btcPrice">
                $--
            </div>
            <div class="stat-grid">
                <div class="stat-box highlight">
                    <div class="stat-value" id="btcChange">--</div>
                    <div class="stat-label">24h Change</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="btcVolume">--</div>
                    <div class="stat-label">24h Volume</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="btcMarketCap">--</div>
                    <div class="stat-label">Market Cap</div>
                </div>
            </div>
        </div>

        <div class="card">
            <h2 style="text-align: center;">üìÖ Market Outlook</h2>
            
            <div id="dailyPrediction" class="prediction-card neutral">
                <div>
                    <div style="font-size: 0.9em; opacity: 0.9; margin-bottom: 8px;">DAILY (24h)</div>
                    <div style="font-size: 2.5em; margin-bottom: 5px;">‚ö™</div>
                    <div style="font-size: 1.5em; font-weight: bold;">LOADING...</div>
                </div>
                <div style="font-size: 2em; font-weight: bold;">--</div>
            </div>

            <div id="weeklyPrediction" class="prediction-card neutral">
                <div>
                    <div style="font-size: 0.9em; opacity: 0.9; margin-bottom: 8px;">WEEKLY (7 days)</div>
                    <div style="font-size: 2.5em; margin-bottom: 5px;">‚ö™</div>
                    <div style="font-size: 1.5em; font-weight: bold;">LOADING...</div>
                </div>
                <div style="font-size: 2em; font-weight: bold;">--</div>
            </div>

            <div id="monthlyPrediction" class="prediction-card neutral">
                <div>
                    <div style="font-size: 0.9em; opacity: 0.9; margin-bottom: 8px;">MONTHLY (30 days)</div>
                    <div style="font-size: 2.5em; margin-bottom: 5px;">‚ö™</div>
                    <div style="font-size: 1.5em; font-weight: bold;">LOADING...</div>
                </div>
                <div style="font-size: 2em; font-weight: bold;">--</div>
            </div>
        </div>

        <div class="card">
            <h2>üåç Macro Indicators (Live)</h2>
            <div class="macro-grid">
                <div id="spxBox" class="macro-box">
                    <div style="font-size: 0.75em; opacity: 0.8; margin-bottom: 4px;">S&P 500</div>
                    <div style="font-size: 1.5em; font-weight: bold;" id="spxValue">--</div>
                    <div style="font-size: 0.7em; margin-top: 8px;" id="spxStatus">...</div>
                </div>

                <div id="dxyBox" class="macro-box">
                    <div style="font-size: 0.75em; opacity: 0.8; margin-bottom: 4px;">DXY (Dollar)</div>
                    <div style="font-size: 1.5em; font-weight: bold;" id="dxyValue">--</div>
                    <div style="font-size: 0.7em; margin-top: 8px;" id="dxyStatus">...</div>
                </div>

                <div id="goldBox" class="macro-box">
                    <div style="font-size: 0.75em; opacity: 0.8; margin-bottom: 4px;">Gold</div>
                    <div style="font-size: 1.5em; font-weight: bold;" id="goldValue">--</div>
                    <div style="font-size: 0.7em; margin-top: 8px;" id="goldStatus">...</div>
                </div>

                <div id="rutBox" class="macro-box">
                    <div style="font-size: 0.75em; opacity: 0.8; margin-bottom: 4px;">Russell 2000</div>
                    <div style="font-size: 1.5em; font-weight: bold;" id="rutValue">--</div>
                    <div style="font-size: 0.7em; margin-top: 8px;" id="rutStatus">...</div>
                </div>

                <div id="vixBox" class="macro-box">
                    <div style="font-size: 0.75em; opacity: 0.8; margin-bottom: 4px;">VIX (Fear)</div>
                    <div style="font-size: 1.5em; font-weight: bold;" id="vixValue">--</div>
                    <div style="font-size: 0.7em; margin-top: 8px;" id="vixStatus">...</div>
                </div>

                <div id="rrpBox" class="macro-box">
                    <div style="font-size: 0.75em; opacity: 0.8; margin-bottom: 4px;">RRP (Liquidity)</div>
                    <div style="font-size: 1.5em; font-weight: bold;" id="rrpValue">--</div>
                    <div style="font-size: 0.7em; margin-top: 8px;" id="rrpStatus">...</div>
                </div>
            </div>

            <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; margin-top: 20px; text-align: center;">
                <div style="font-size: 1.2em; font-weight: bold; margin-bottom: 10px;">Environment Summary</div>
                <div id="summaryText" style="font-size: 1.1em;">Analyzing markets...</div>
            </div>
        </div>

        <div class="fed-section">
            <h2>üè¶ Federal Reserve Policy</h2>
            <div class="fed-grid">
                <div class="fed-box">
                    <div style="opacity: 0.8; font-size: 0.85em;">Fed Funds Rate</div>
                    <div style="font-size: 2em; font-weight: bold; margin: 10px 0;" id="fedRate">--%</div>
                </div>
                <div class="fed-box">
                    <div style="opacity: 0.8; font-size: 0.85em;">Rate Cut Probability</div>
                    <div style="font-size: 2em; font-weight: bold; margin: 10px 0; color: #3b82f6;" id="cutProb">--%</div>
                    <div style="font-size: 0.75em; margin-top: 5px;">Next: <span id="nextMeeting">--</span></div>
                </div>
                <div class="fed-box">
                    <div style="opacity: 0.8; font-size: 0.85em;">Balance Sheet</div>
                    <div style="font-size: 2em; font-weight: bold; margin: 10px 0;" id="fedBalance">$--B</div>
                    <div id="qtStatus" style="font-size: 0.85em; padding: 5px 10px; border-radius: 15px; display: inline-block; margin-top: 5px;">--</div>
                </div>
            </div>
        </div>

        <button onclick="fetchMarketData()">üîÑ Refresh Now</button>

        <div style="text-align: center; padding: 25px; opacity: 0.7; font-size: 0.85em;">
            <p>üìä Auto-updates every 5 seconds</p>
            <p style="font-size: 0.8em; margin-top: 10px;">‚ö†Ô∏è Not financial advice</p>
        </div>
    </div>

    <script>
        const BACKEND_URL = "https://bitcoin-pro-backend.onrender.com";

        function calculatePrediction(price, change, days) {
            const volatility = Math.abs(change) / 100;
            const trend = change > 0 ? 1 : -1;
            const prediction = price * (1 + (trend * volatility * days * (Math.random() * 0.3 + 0.7)));
            const pctChange = ((prediction - price) / price) * 100;
            
            let sentiment, emoji, className;
            if (pctChange > 5) { sentiment = "VERY BULLISH"; emoji = "üöÄ"; className = "bullish"; }
            else if (pctChange > 0) { sentiment = "BULLISH"; emoji = "üìà"; className = "bullish"; }
            else if (pctChange > -5) { sentiment = "BEARISH"; emoji = "üìâ"; className = "bearish"; }
            else { sentiment = "VERY BEARISH"; emoji = "‚ö†Ô∏è"; className = "bearish"; }
            
            return { price: Math.round(prediction), sentiment, emoji, className };
        }

        async function fetchMarketData() {
            try {
                document.getElementById("statusBadge").className = "status live";
                document.getElementById("statusBadge").textContent = "üü¢ LIVE";

                const response = await fetch(`${BACKEND_URL}/markets`);
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const data = await response.json();

                document.getElementById("lastUpdate").textContent = new Date().toLocaleTimeString();

                // Bitcoin
                document.getElementById("btcPrice").textContent = "$" + data.bitcoin.price.toLocaleString();
                const changeEl = document.getElementById("btcChange");
                changeEl.textContent = (data.bitcoin.change24h > 0 ? "+" : "") + data.bitcoin.change24h + "%";
                changeEl.style.color = data.bitcoin.change24h >= 0 ? "#10b981" : "#ef4444";
                document.getElementById("btcVolume").textContent = "$" + data.bitcoin.volume24h + "B";
                document.getElementById("btcMarketCap").textContent = "$" + data.bitcoin.marketCap + "T";

                // Predictions
                const daily = calculatePrediction(data.bitcoin.price, data.bitcoin.change24h, 1);
                const weekly = calculatePrediction(data.bitcoin.price, data.bitcoin.change24h, 7);
                const monthly = calculatePrediction(data.bitcoin.price, data.bitcoin.change24h, 30);

                const dailyCard = document.getElementById("dailyPrediction");
                dailyCard.className = "prediction-card " + daily.className;
                dailyCard.innerHTML = `
                    <div>
                        <div style="font-size: 0.9em; opacity: 0.9; margin-bottom: 8px;">DAILY (24h)</div>
                        <div style="font-size: 2.5em; margin-bottom: 5px;">${daily.emoji}</div>
                        <div style="font-size: 1.5em; font-weight: bold;">${daily.sentiment}</div>
                    </div>
                    <div style="font-size: 2em; font-weight: bold;">$${daily.price.toLocaleString()}</div>
                `;

                const weeklyCard = document.getElementById("weeklyPrediction");
                weeklyCard.className = "prediction-card " + weekly.className;
                weeklyCard.innerHTML = `
                    <div>
                        <div style="font-size: 0.9em; opacity: 0.9; margin-bottom: 8px;">WEEKLY (7 days)</div>
                        <div style="font-size: 2.5em; margin-bottom: 5px;">${weekly.emoji}</div>
                        <div style="font-size: 1.5em; font-weight: bold;">${weekly.sentiment}</div>
                    </div>
                    <div style="font-size: 2em; font-weight: bold;">$${weekly.price.toLocaleString()}</div>
                `;

                const monthlyCard = document.getElementById("monthlyPrediction");
                monthlyCard.className = "prediction-card " + monthly.className;
                monthlyCard.innerHTML = `
                    <div>
                        <div style="font-size: 0.9em; opacity: 0.9; margin-bottom: 8px;">MONTHLY (30 days)</div>
                        <div style="font-size: 2.5em; margin-bottom: 5px;">${monthly.emoji}</div>
                        <div style="font-size: 1.5em; font-weight: bold;">${monthly.sentiment}</div>
                    </div>
                    <div style="font-size: 2em; font-weight: bold;">$${monthly.price.toLocaleString()}</div>
                `;

                // Macro Indicators
                const m = data.marketData;
                
                document.getElementById("spxValue").textContent = m.spx.toLocaleString();
                document.getElementById("spxStatus").textContent = m.spx > 5700 ? "‚úÖ Risk-On" : "‚ùå Risk-Off";
                document.getElementById("spxBox").className = m.spx > 5700 ? "macro-box bullish" : "macro-box bearish";

                document.getElementById("dxyValue").textContent = m.dxy;
                document.getElementById("dxyStatus").textContent = m.dxy < 105 ? "‚úÖ Bullish" : "‚ùå Bearish";
                document.getElementById("dxyBox").className = m.dxy < 105 ? "macro-box bullish" : "macro-box bearish";

                document.getElementById("goldValue").textContent = "$" + m.gold;
                document.getElementById("goldStatus").textContent = m.gold > 2600 && m.gold < 3000 ? "‚úÖ Bullish" : "‚ùå Bearish";
                document.getElementById("goldBox").className = m.gold > 2600 && m.gold < 3000 ? "macro-box bullish" : "macro-box bearish";

                document.getElementById("rutValue").textContent = m.rut.toLocaleString();
                document.getElementById("rutStatus").textContent = m.rut > 2500 ? "‚úÖ Risk-On" : "‚ùå Risk-Off";
                document.getElementById("rutBox").className = m.rut > 2500 ? "macro-box bullish" : "macro-box bearish";

                document.getElementById("vixValue").textContent = m.vix;
                document.getElementById("vixStatus").textContent = m.vix < 20 ? "‚úÖ Low Fear" : "‚ùå High Fear";
                document.getElementById("vixBox").className = m.vix < 20 ? "macro-box bullish" : "macro-box bearish";

                document.getElementById("rrpValue").textContent = "$" + data.fedData.rrp + "B";
                document.getElementById("rrpStatus").textContent = data.fedData.rrp < 300 ? "‚úÖ High Liquidity" : "‚ùå Low Liquidity";
                document.getElementById("rrpBox").className = data.fedData.rrp < 300 ? "macro-box bullish" : "macro-box bearish";

                // Fed Data
                document.getElementById("fedRate").textContent = data.fedData.fedFunds.toFixed(2) + "%";
                document.getElementById("cutProb").textContent = (data.fedData.fedCutProbability * 100).toFixed(0) + "%";
                document.getElementById("nextMeeting").textContent = data.fedData.nextMeetingDate;
                document.getElementById("fedBalance").textContent = "$" + data.fedData.fedBalance + "B";
                
                const qtEl = document.getElementById("qtStatus");
                if (data.fedData.qtActive) {
                    qtEl.textContent = "üî¥ QT Active";
                    qtEl.style.background = "#ef4444";
                } else {
                    qtEl.textContent = "üü¢ QE Active";
                    qtEl.style.background = "#10b981";
                }

                // Summary
                let bullish = 0;
                if (m.spx > 5700) bullish++;
                if (m.dxy < 105) bullish++;
                if (m.gold > 2600 && m.gold < 3000) bullish++;
                if (m.rut > 2500) bullish++;
                if (m.vix < 20) bullish++;
                if (data.fedData.rrp < 300) bullish++;

                const score = bullish;
                let summary;
                if (score >= 5) summary = "üöÄ VERY BULLISH - Strong macro support for Bitcoin!";
                else if (score >= 4) summary = "üìà BULLISH - Favorable conditions for risk assets";
                else if (score >= 3) summary = "‚öñÔ∏è NEUTRAL - Mixed signals across markets";
                else if (score >= 2) summary = "üìâ BEARISH - Challenging macro environment";
                else summary = "‚ö†Ô∏è VERY BEARISH - Significant headwinds present";

                document.getElementById("summaryText").textContent = summary;

            } catch (error) {
                console.error("Error:", error);
                document.getElementById("statusBadge").className = "status error";
                document.getElementById("statusBadge").textContent = "üî¥ ERROR";
            }
        }

        window.addEventListener("load", () => {
            fetchMarketData();
            setInterval(fetchMarketData, 5000);
        });
    </script>
</body>
</html>
